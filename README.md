# Arabic Chatbot API (FastAPI + OpenRouter) with optional RAG

ุชุดุงุช ุจูุช ุนุฑุจู ูุน ุชูุงูู OpenRouterุ ูุฏุนู ุงุฎุชูุงุฑู ูู RAG ุจุงุณุชุฎุฏุงู LangChain ูRedis Vector Storeุ ูุน ูุงุฌูุฉ ูุญุงุฏุซุฉ ุฌูููุฉ ุดุจููุฉ ุจู ChatGPT.

## โจ ุงููููุฒุงุช

- ๐ค **ูุงุฌูุฉ ูุญุงุฏุซุฉ ุฌูููุฉ**: ุชุตููู ุนุตุฑู ุดุจูู ุจู ChatGPT ูุน ุฏุนู ุงููุบุฉ ุงูุนุฑุจูุฉ
- ๐ **API ููู**: FastAPI ูุน ุฏุนู Facebook Messenger ูWhatsApp
- ๐ง **ุฐูุงุก ุงุตุทูุงุนู**: ุชูุงูู ูุน OpenRouter ููู LLM
- ๐ **RAG ุงุฎุชูุงุฑู**: ุงุณุชุฑุฌุงุน ูุนูููุงุช ูู ูุงุนุฏุฉ ูุนุฑูุฉ ูุฎุตุตุฉ
- ๐ฑ **ุชุตููู ูุชุฌุงูุจ**: ูุนูู ุนูู ุฌููุน ุงูุฃุฌูุฒุฉ
- ๐ **ูุถุน ุงูุธูุงู**: ุฏุนู ูุงูู ูููุถุน ุงููุธูู
- ๐พ **ุชุฎุฒูู ูุญูู**: ุญูุธ ุชุงุฑูุฎ ุงููุญุงุฏุซุงุช ูู ุงููุชุตูุญ

## ๐ Quick start

### 1. ุฅุนุฏุงุฏ ุงูุจูุฆุฉ
```bash
# ูุณุฎ ููู ุงูุจูุฆุฉ
cp env.example .env

# ุชุนุฏูู ุงููุชุบูุฑุงุช ูู .env
# OPENROUTER_API_KEY=sk-or-...
# FACEBOOK_VERIFY_TOKEN=123456789
# FACEBOOK_PAGE_ACCESS_TOKEN=your_token_here
# FB_GRAPH_VERSION=v18.0
# OPENAI_API_KEY=sk-... (ุงุฎุชูุงุฑู ููู RAG)
```

### 2. ุชุซุจูุช ุงูุชุจุนูุงุช
```bash
pip install -r requirements.txt
```

### 3. ุชุดุบูู ุงูุชุทุจูู
```bash
uvicorn main:app --host 0.0.0.0 --port 8080
```

### 4. ุงููุตูู ูููุงุฌูุฉ
- **API**: http://localhost:8080
- **ุงููุงุฌูุฉ**: http://localhost:8080/ui
- **ุงูุชูุซูู**: http://localhost:8080/docs

## ๐จ ุงููุงุฌูุฉ

### ุงููููุฒุงุช
- ุชุตููู ุนุฑุจู ุฌููู ูุนุตุฑู
- ุฏุนู ุงููุถุน ุงููุธูู/ุงููุงุชุญ
- ูุคุดุฑุงุช ุงููุชุงุจุฉ
- ุชุงุฑูุฎ ุงููุญุงุฏุซุงุช
- ุชุตููู ูุชุฌุงูุจ ููููุจุงูู

### ุงูุงุณุชุฎุฏุงู
1. ุงูุชุจ ุฑุณุงูุชู ูู ุญูู ุงูุฅุฏุฎุงู
2. ุงุถุบุท Enter ุฃู ุฒุฑ ุงูุฅุฑุณุงู
3. ุงูุชุธุฑ ุฑุฏ ุงููุณุงุนุฏ
4. ุงุณุชุฎุฏู ุฒุฑ "ูุญุงุฏุซุฉ ุฌุฏูุฏุฉ" ูุจุฏุก ูุญุงุฏุซุฉ ุฌุฏูุฏุฉ
5. ุงุณุชุฎุฏู ุฒุฑ ุงูููุฑ/ุงูุดูุณ ูุชุจุฏูู ุงููุถุน

## ๐ง ุงูุชูููู

### ุงููุชุบูุฑุงุช ุงูุฃุณุงุณูุฉ
- `OPENROUTER_API_KEY`: ููุชุงุญ API ูู OpenRouter
- `OPENROUTER_MODEL`: ูููุฐุฌ LLM ุงููุณุชุฎุฏู
- `SYSTEM_PROMPT`: ุฑุณุงูุฉ ุงููุธุงู ุงูุฃุณุงุณูุฉ

### ูุชุบูุฑุงุช RAG (ุงุฎุชูุงุฑูุฉ)
- `RAG_ENABLED`: ุชูุนูู/ุชุนุทูู RAG
- `OPENAI_API_KEY`: ููุชุงุญ OpenAI ููู embeddings
- `REDIS_URL`: ุฑุงุจุท Redis
- `RAG_INDEX_NAME`: ุงุณู ููุฑุณ RAG

## ๐ RAG

### ุชูุนูู RAG
1. ุชุฃูุฏ ูู ูุฌูุฏ Redis
2. ุฃุถู `OPENAI_API_KEY` ูู `.env`
3. ุดุบู `RAG_ENABLED=true`

### ุฅุฏุฎุงู ุงูุจูุงูุงุช
```bash
# ุฅูุดุงุก ููู CSV ููููุชุฌุงุช
python rag/ingest.py --source data/catalog.csv --index rag:retail_agri
```

### ุชูุณูู CSV
```csv
name,description,price,unit
ุจุฐูุฑ ุทูุงุทู,ุจุฐูุฑ ุทูุงุทู ุนุถููุฉ ุนุงููุฉ ุงูุฌูุฏุฉ,25,ูููู
ุณูุงุฏ ุนุถูู,ุณูุงุฏ ุทุจูุนู ููุฎุถุฑูุงุช,50,ูููู
```

## ๐ API Endpoints

- `GET /`: ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
- `GET /ui`: ูุงุฌูุฉ ุงููุญุงุฏุซุฉ
- `POST /chat`: ุฅุฑุณุงู ุฑุณุงูุฉ
- `GET /health`: ูุญุต ุตุญุฉ ุงูุชุทุจูู
- `GET /rag/status`: ุญุงูุฉ RAG
- `GET /metrics`: ุฅุญุตุงุฆูุงุช ุงูุฃุฏุงุก

## ๐ฑ ุงูููุตุงุช ุงููุฏุนููุฉ

- **Facebook Messenger**: webhook ูู `/webhook`
- **WhatsApp**: webhook ูู `/webhook`
- **API ูุจุงุดุฑ**: endpoint ูู `/chat`

## ๐๏ธ ุงูุชุทููุฑ

### ูููู ุงููุดุฑูุน
```
bot-master/
โโโ main.py              # FastAPI app
โโโ services.py          # ููุทู ุงูุฃุนูุงู
โโโ config.py            # ุงูุฅุนุฏุงุฏุงุช
โโโ exceptions.py        # ุงูุงุณุชุซูุงุกุงุช
โโโ static/              # ูููุงุช ุงููุงุฌูุฉ
โ   โโโ index.html      # HTML ุงูุฑุฆูุณู
โ   โโโ styles.css      # ุงูุชุตููู
โ   โโโ script.js       # JavaScript
โโโ rag/                 # ูููุงุช RAG
โ   โโโ ingest.py       # ุณูุฑุจุช ุงูุฅุฏุฎุงู
โโโ requirements.txt     # ุงูุชุจุนูุงุช
```

### ุฅุถุงูุฉ ููุฒุงุช ุฌุฏูุฏุฉ
1. ุนุฏูู `services.py` ููููุทู
2. ุฃุถู endpoints ูู `main.py`
3. ุญุฏุซ ุงููุงุฌูุฉ ูู `static/`

## ๐ ุงููุดุฑ

### Docker
```bash
docker build -t arabic-chatbot .
docker run -p 8080:8080 --env-file .env arabic-chatbot
```

### Heroku/Render
- ุงุณุชุฎุฏู `Procfile` ู `runtime.txt`
- ุฃุถู ูุชุบูุฑุงุช ุงูุจูุฆุฉ ูู ููุญุฉ ุงูุชุญูู

## ๐ ุงูุชุฑุฎูุต

ูุฐุง ุงููุดุฑูุน ููุชูุญ ุงููุตุฏุฑ ููุชุงุญ ููุงุณุชุฎุฏุงู ุงูุชุฌุงุฑู.

## ๐ค ุงููุณุงููุฉ

ูุฑุญุจ ุจุงููุณุงููุงุช! ูุฑุฌู:
1. Fork ุงููุดุฑูุน
2. ุฅูุดุงุก branch ููููุฒุฉ ุงูุฌุฏูุฏุฉ
3. Commit ุงูุชุบููุฑุงุช
4. Push ููู branch
5. ุฅูุดุงุก Pull Request

## ๐ ุงูุฏุนู

ูููุณุงุนุฏุฉ ุฃู ุงูุฃุณุฆูุฉ:
- ุงูุชุญ issue ูู GitHub
- ุฑุงุฌุน ุงูุชูุซูู ูู `/docs`
- ุชุญูู ูู `/health` ููุญุต ุญุงูุฉ ุงูุชุทุจูู


